window.Modules8.registerModule({moduleId:"b6dd7aae-c75b-41f2-b3fa-2dd7204a3cbe",module:function(_context_){
var _api_
!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){e.exports=_context_.config},function(e,t,n){_api_=n(2)},function(e,t,n){"use strict";n.r(t);var i=n(0),r=function(e){return e?Array.isArray(e)?e:e.materials?e.materials:[e]:[]},a=function(e,t){e&&e.traverse((function(e){e.isMesh&&r(e.material).forEach((function(e){e&&!("envMap"in e)||(e.envMap=t,e.needsUpdate=!0)}))}))},s=function(e,t,n,i){e&&(t=t||[],e.traverse((function(e){e.isMesh&&r(e.material).forEach((function(e){e&&!("envMap"in e)||t.length&&-1===t.indexOf(e.name)||(e.envMap=n,e.reflectivity=i,e.needsUpdate=!0)}))})))},o=[],l={schema:{type:{type:"string",default:"realtime"},posx:{type:"string"},posy:{type:"string"},posz:{type:"string"},negx:{type:"string"},negy:{type:"string"},negz:{type:"string"},extension:{default:"jpg",oneOf:["jpg","png"]},format:{default:"RGBAFormat",oneOf:["RGBFormat","RGBAFormat"]},enableBackground:{default:!1},reflectivity:{default:1,min:0,max:1},materials:{default:[]}},setReflections:function(){var e=this;if("realtime"===this.data.type){this.data;var t=this.el.sceneEl,n=function(){for(var e=Math.floor(1e3*Math.random())+1;o.includes(e);)e=Math.floor(1e3*Math.random())+1;return o.push(e),e.toString()}(),i=new THREE.Texture,r=new THREE.MeshBasicMaterial({side:THREE.DoubleSide,color:16777215,map:i}),l=new THREE.WebGLCubeRenderTarget(256,{format:THREE.RGBFormat,generateMipmaps:!0,minFilter:THREE.LinearMipmapLinearFilter,encoding:THREE.sRGBEncoding}),u=new THREE.Scene,c=new THREE.CubeCamera(1,1e3,l),d=new THREE.SphereGeometry(100,15,15),f=new THREE.Mesh(d,r);f.scale.set(-1,1,1),f.rotation.set(Math.PI,-Math.PI/2,0),u.add(f);var h=function(){window.XR8.XrController.configure({enableLighting:!0}),window.XR8.addCameraPipelineModule({name:n,onUpdate:function(){c.update(t.renderer,u)},onProcessCpu:function(e){var n=e.frameStartResult.cameraTexture;t.renderer.properties.get(i).__webglTexture=n}})};window.XR8?h():window.addEventListener("xrloaded",h);var g=this.el.getObject3D("mesh");g?a(g,c.renderTarget.texture):this.el.sceneEl.addEventListener("realityready",(function(){a(e.el.getObject3D("mesh"),c.renderTarget.texture)})),this.el.addEventListener("model-loaded",(function(){a(e.el.getObject3D("mesh"),c.renderTarget.texture)}))}else if("static"===this.data.type){var p=this.data;["posx","posy","posz","negx","negy","negz"].forEach((function(t){p[t]&&p[t].startsWith("https://")?e[t]=p[t]:p[t]&&(e[t]=document.getElementById(p[t]).src)})),this.texture=(new THREE.CubeTextureLoader).load([this.posx,this.negx,this.posy,this.negy,this.posz,this.negz]),this.texture.format=THREE[p.format];var m=this.el.getObject3D("mesh");m?s(m,p.materials,this.texture,p.reflectivity):this.el.addEventListener("model-loaded",(function(){s(e.el.getObject3D("mesh"),p.materials,e.texture,p.reflectivity)}))}},init:function(){this.posx=null,this.posy=null,this.posz=null,this.negx=null,this.negy=null,this.negz=null,this.setReflections()},update:function(e){var t=this;if("static"===this.data.type){Object(i.subscribe)((function(e){t.posx=e["static-posx"],t.posy=e["static-posy"],t.posz=e["static-posz"],t.negx=e["static-negx"],t.negy=e["static-negy"],t.negz=e["static-negz"],t.setReflections()}));var n=this.data,r=this.el.getObject3D("mesh"),a=[],o=[];if(n.materials.length&&(e.materials?(a=n.materials.filter((function(t){return!e.materials.includes(t)})),o=e.materials.filter((function(e){return!n.materials.includes(e)}))):a=n.materials),a.length&&s(r,a,this.texture,n.reflectivity),o.length&&s(r,o,null,1),e.materials&&n.reflectivity!==e.reflectivity){var l=n.materials.filter((function(t){return e.materials.includes(t)}));l.length&&s(r,l,this.texture,n.reflectivity)}this.data.enableBackground&&!e.enableBackground?this.setBackground(this.texture):!this.data.enableBackground&&e.enableBackground&&this.setBackground(null)}this.setReflections()},remove:function(){if("static"===this.data.type){this.el.removeEventListener("object3dset",this.object3dsetHandler);var e=this.el.getObject3D("mesh"),t=this.data;s(e,t.materials,null,1),t.enableBackground&&this.setBackground(null)}},setBackground:function(e){this.el.sceneEl.object3D.background=e}},u={init:function(){var e=this;this.intensity=1;var t=function(){window.XR8.XrController.configure({enableLighting:!0}),window.XR8.addCameraPipelineModule({name:"xr-light",onUpdate:function(t){var n=t.processCpuResult;n.reality&&n.reality.lighting&&n.reality.lighting.exposure&&(e.intensity=1+n.reality.lighting.exposure)}})};window.XR8?t():window.addEventListener("xrloaded",t)}},c={schema:{min:{default:0},max:{default:2}},tick:function(){this.el.setAttribute("light","intensity: ".concat(Math.max(this.data.min,Math.min(this.system.intensity,this.data.max))))}};AFRAME.registerComponent("reflections",l),AFRAME.registerComponent("xr-light",c),AFRAME.registerSystem("xr-light",u)}]);
return {api:_api_}
},defaultConfig:{"static-negx":"https://static.8thwall.app/assets/negx-usakunc32h.jpg","static-negy":"https://static.8thwall.app/assets/negy-3bc23963o1.jpg","static-negz":"https://static.8thwall.app/assets/negz-ejw9qfu9s8.jpg","static-posx":"https://static.8thwall.app/assets/posx-18rp6o89l4.jpg","static-posy":"https://static.8thwall.app/assets/posy-8jb5kfu3d4.jpg","static-posz":"https://static.8thwall.app/assets/posz-25i1e465i1.jpg"}})
